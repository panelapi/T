import{ad as L,ae as q,af as R,k as J,d as p,l as K,m as Z}from"./vendor-b5206b48.js";import{s as j,S as B,A as Q}from"./index-d1ccb639.js";function mt(){return j({url:B+"/api/v1/user/plan/fetch",method:"get"})}function pt(n){return j({url:B+"/api/v1/user/coupon/check",method:"post",data:n})}function $t(n){return j({url:B+"/api/v1/user/order/save",method:"post",params:n})}function X(){return j({url:B+"/api/v1/user/getSubscribe",method:"get"})}function tt(n){return typeof n>"u"||n===null||String(n).trim()===""}class et{constructor(s){this.defination=s,this.parseDefination()}parseDefination(){Object.keys(this.defination).forEach(s=>{this[s]=this.defination[s][0]})}toArray(){return Object.keys(this.defination).map(a=>{const r=this.defination[a];return{value:r[0],label:r[1]}})}getLabel(s){const a=this.toArray().find(r=>String(r.value)===String(s));return a?a.label:""}}function _(n){return new et(n)}const T=_({UNBUY:[1,"未购买"],PERIOD:[2,"周期性订阅"],ONE_TIME:[3,"一次性订阅"]}),bt=_({WAIT_PAY:[0,"待支付"],OPENING:[1,"开通中"],CANCEL:[2,"已取消"],END:[3,"已完成"]});function st(n,s){for(const a in s)n[a]=s[a]}const A={};async function nt(n,s,...a){const r={refresh:0,...s};if(A[n.name]&&!r.refresh)return A[n.name];{const $=await n(...a);return A[n.name]=$,$}}var I={exports:{}};/*!
 * bytes
 * Copyright(c) 2012-2014 TJ Holowaychuk
 * Copyright(c) 2015 Jed Watson
 * MIT Licensed
 */I.exports=ot;I.exports.format=U;I.exports.parse=G;var rt=/\B(?=(\d{3})+(?!\d))/g,it=/(?:\.0*|(\.[^0]+)0+)$/,S={b:1,kb:1024,mb:1<<20,gb:1<<30,tb:Math.pow(1024,4),pb:Math.pow(1024,5)},at=/^((-|\+)?(\d+(?:\.\d+)?)) *(kb|mb|gb|tb|pb)$/i;function ot(n,s){return typeof n=="string"?G(n):typeof n=="number"?U(n,s):null}function U(n,s){if(!Number.isFinite(n))return null;var a=Math.abs(n),r=s&&s.thousandsSeparator||"",$=s&&s.unitSeparator||"",g=s&&s.decimalPlaces!==void 0?s.decimalPlaces:2,x=!!(s&&s.fixedDecimals),d=s&&s.unit||"";(!d||!S[d.toLowerCase()])&&(a>=S.pb?d="PB":a>=S.tb?d="TB":a>=S.gb?d="GB":a>=S.mb?d="MB":a>=S.kb?d="KB":d="B");var N=n/S[d.toLowerCase()],b=N.toFixed(g);return x||(b=b.replace(it,"$1")),r&&(b=b.split(".").map(function(y,Y){return Y===0?y.replace(rt,r):y}).join(".")),b+$+d}function G(n){if(typeof n=="number"&&!isNaN(n))return n;if(typeof n!="string")return null;var s=at.exec(n),a,r="b";return s?(a=parseFloat(s[1]),r=s[4].toLowerCase()):(a=parseInt(n,10),r="b"),isNaN(a)?null:Math.floor(S[r]*a)}var ut=I.exports;const ct=L(ut);var W={exports:{}};(function(n,s){(function(a,r){n.exports=r()})(q,function(){var a,r,$=1e3,g=6e4,x=36e5,d=864e5,N=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,b=31536e6,y=2628e6,Y=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/,w={years:b,months:y,days:d,hours:x,minutes:g,seconds:$,milliseconds:1,weeks:6048e5},k=function(i){return i instanceof P},D=function(i,e,t){return new P(i,t,e.$l)},E=function(i){return r.p(i)+"s"},l=function(i){return i<0},h=function(i){return l(i)?Math.ceil(i):Math.floor(i)},F=function(i){return Math.abs(i)},M=function(i,e){return i?l(i)?{negative:!0,format:""+F(i)+e}:{negative:!1,format:""+i+e}:{negative:!1,format:""}},P=function(){function i(t,o,c){var u=this;if(this.$d={},this.$l=c,t===void 0&&(this.$ms=0,this.parseFromMilliseconds()),o)return D(t*w[E(o)],this);if(typeof t=="number")return this.$ms=t,this.parseFromMilliseconds(),this;if(typeof t=="object")return Object.keys(t).forEach(function(v){u.$d[E(v)]=t[v]}),this.calMilliseconds(),this;if(typeof t=="string"){var f=t.match(Y);if(f){var m=f.slice(2).map(function(v){return v!=null?Number(v):0});return this.$d.years=m[0],this.$d.months=m[1],this.$d.weeks=m[2],this.$d.days=m[3],this.$d.hours=m[4],this.$d.minutes=m[5],this.$d.seconds=m[6],this.calMilliseconds(),this}}return this}var e=i.prototype;return e.calMilliseconds=function(){var t=this;this.$ms=Object.keys(this.$d).reduce(function(o,c){return o+(t.$d[c]||0)*w[c]},0)},e.parseFromMilliseconds=function(){var t=this.$ms;this.$d.years=h(t/b),t%=b,this.$d.months=h(t/y),t%=y,this.$d.days=h(t/d),t%=d,this.$d.hours=h(t/x),t%=x,this.$d.minutes=h(t/g),t%=g,this.$d.seconds=h(t/$),t%=$,this.$d.milliseconds=t},e.toISOString=function(){var t=M(this.$d.years,"Y"),o=M(this.$d.months,"M"),c=+this.$d.days||0;this.$d.weeks&&(c+=7*this.$d.weeks);var u=M(c,"D"),f=M(this.$d.hours,"H"),m=M(this.$d.minutes,"M"),v=this.$d.seconds||0;this.$d.milliseconds&&(v+=this.$d.milliseconds/1e3,v=Math.round(1e3*v)/1e3);var C=M(v,"S"),z=t.negative||o.negative||u.negative||f.negative||m.negative||C.negative,V=f.format||m.format||C.format?"T":"",H=(z?"-":"")+"P"+t.format+o.format+u.format+V+f.format+m.format+C.format;return H==="P"||H==="-P"?"P0D":H},e.toJSON=function(){return this.toISOString()},e.format=function(t){var o=t||"YYYY-MM-DDTHH:mm:ss",c={Y:this.$d.years,YY:r.s(this.$d.years,2,"0"),YYYY:r.s(this.$d.years,4,"0"),M:this.$d.months,MM:r.s(this.$d.months,2,"0"),D:this.$d.days,DD:r.s(this.$d.days,2,"0"),H:this.$d.hours,HH:r.s(this.$d.hours,2,"0"),m:this.$d.minutes,mm:r.s(this.$d.minutes,2,"0"),s:this.$d.seconds,ss:r.s(this.$d.seconds,2,"0"),SSS:r.s(this.$d.milliseconds,3,"0")};return o.replace(N,function(u,f){return f||String(c[u])})},e.as=function(t){return this.$ms/w[E(t)]},e.get=function(t){var o=this.$ms,c=E(t);return c==="milliseconds"?o%=1e3:o=c==="weeks"?h(o/w[c]):this.$d[c],o||0},e.add=function(t,o,c){var u;return u=o?t*w[E(o)]:k(t)?t.$ms:D(t,this).$ms,D(this.$ms+u*(c?-1:1),this)},e.subtract=function(t,o){return this.add(t,o,!0)},e.locale=function(t){var o=this.clone();return o.$l=t,o},e.clone=function(){return D(this.$ms,this)},e.humanize=function(t){return a().add(this.$ms,"ms").locale(this.$l).fromNow(!t)},e.valueOf=function(){return this.asMilliseconds()},e.milliseconds=function(){return this.get("milliseconds")},e.asMilliseconds=function(){return this.as("milliseconds")},e.seconds=function(){return this.get("seconds")},e.asSeconds=function(){return this.as("seconds")},e.minutes=function(){return this.get("minutes")},e.asMinutes=function(){return this.as("minutes")},e.hours=function(){return this.get("hours")},e.asHours=function(){return this.as("hours")},e.days=function(){return this.get("days")},e.asDays=function(){return this.as("days")},e.weeks=function(){return this.get("weeks")},e.asWeeks=function(){return this.as("weeks")},e.months=function(){return this.get("months")},e.asMonths=function(){return this.as("months")},e.years=function(){return this.get("years")},e.asYears=function(){return this.as("years")},i}(),O=function(i,e,t){return i.add(e.years()*t,"y").add(e.months()*t,"M").add(e.days()*t,"d").add(e.hours()*t,"h").add(e.minutes()*t,"m").add(e.seconds()*t,"s").add(e.milliseconds()*t,"ms")};return function(i,e,t){a=t,r=t().$utils(),t.duration=function(u,f){var m=t.locale();return D(u,{$l:m},f)},t.isDuration=k;var o=e.prototype.add,c=e.prototype.subtract;e.prototype.add=function(u,f){return k(u)?O(this,u,1):o.bind(this)(u,f)},e.prototype.subtract=function(u,f){return k(u)?O(this,u,-1):c.bind(this)(u,f)}}})})(W);var dt=W.exports;const lt=L(dt);R.extend(lt);function yt(n=0){const s=J({loaded:!1,d:0,u:0}),a=p(()=>s.plan_id),r=p(()=>s.expired_at),$=p(()=>s.d+s.u),g=p(()=>s.transfer_enable??0),x=p(()=>Math.max(g.value-$.value,0)),d=p(()=>parseFloat(($.value/g.value*100).toFixed(2))),N=p(()=>{var l;return Number((l=s.plan)==null?void 0:l.renew)===1}),b=p(()=>tt(K.get(Q))),y=p(()=>r.value!==null?R.unix(r.value).diff(R(),"second"):null),Y=p(()=>y.value!==null?parseFloat((y.value/3600/24).toFixed(0)):null),w=p(()=>{const l=y.value;if(l===null)return"";if(l<60)return l+" 秒";const h=R.duration(l,"seconds"),F=h.years(),M=h.months(),P=h.days(),O=h.hours(),i=h.minutes();return[F>0?F+" 年":"",M>0?M+" 月":"",P>0?P+" 天":"",O>0?O+" 小时":"",i>0?i+" 分钟":""].filter(e=>e.length>0).join(" ")}),k=p(()=>s.loaded?s.plan===null?T.UNBUY:s.expired_at===null?T.ONE_TIME:T.PERIOD:null),D=p(()=>{const l=ct(x.value,{unitSeparator:"-"}).split("-");return{num:l[0],unit:l[1]}});Z(()=>{b.value||E()});async function E(){const l=await nt(X,{refresh:Number(n)});st(s,l.data),s.loaded=!0}return{subscribe:s,comboType:k,planId:a,expiredDate:r,expiredDays:Y,usedFlow:$,allFlow:g,leftFlow:x,leftFlowObj:D,percent:d,renewable:N,expiredResidue:y,expiredResidueDuration:w}}export{bt as P,mt as a,X as g,tt as i,$t as m,yt as u,pt as v,nt as w};
